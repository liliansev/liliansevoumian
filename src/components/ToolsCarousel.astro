---
import { Icon } from 'astro-icon/components';
import ScrollFade from './ui/ScrollFade.astro';

interface Tool {
  name: string;
  icon: string;
}

const row1: Tool[] = [
  { name: "Zapier", icon: "simple-icons:zapier" },
  { name: "Airtable", icon: "simple-icons:airtable" },
  { name: "Notion", icon: "simple-icons:notion" },
  { name: "ClickUp", icon: "simple-icons:clickup" },
  { name: "Asana", icon: "simple-icons:asana" },
  { name: "Trello", icon: "simple-icons:trello" },
  { name: "Webflow", icon: "simple-icons:webflow" },
  { name: "Todoist", icon: "simple-icons:todoist" },
  { name: "Linear", icon: "simple-icons:linear" },
  { name: "Google Sheets", icon: "simple-icons:googlesheets" },
  { name: "Google Drive", icon: "simple-icons:googledrive" },
  { name: "Dropbox", icon: "simple-icons:dropbox" },
  { name: "Loom", icon: "simple-icons:loom" },
];

const row2: Tool[] = [
  { name: "Slack", icon: "simple-icons:slack" },
  { name: "Discord", icon: "simple-icons:discord" },
  { name: "Gmail", icon: "simple-icons:gmail" },
  { name: "HubSpot", icon: "simple-icons:hubspot" },
  { name: "Salesforce", icon: "simple-icons:salesforce" },
  { name: "Zendesk", icon: "simple-icons:zendesk" },
  { name: "Intercom", icon: "simple-icons:intercom" },
  { name: "Typeform", icon: "simple-icons:typeform" },
  { name: "Calendly", icon: "simple-icons:calendly" },
  { name: "Zoom", icon: "simple-icons:zoom" },
  { name: "Mailchimp", icon: "simple-icons:mailchimp" },
  { name: "Brevo", icon: "simple-icons:brevo" },
];

const row3: Tool[] = [
  { name: "Stripe", icon: "simple-icons:stripe" },
  { name: "PayPal", icon: "simple-icons:paypal" },
  { name: "Shopify", icon: "simple-icons:shopify" },
  { name: "WooCommerce", icon: "simple-icons:woocommerce" },
  { name: "Telegram", icon: "simple-icons:telegram" },
  { name: "Messenger", icon: "simple-icons:messenger" },
  { name: "Google Calendar", icon: "simple-icons:googlecalendar" },
  { name: "LinkedIn", icon: "simple-icons:linkedin" },
  { name: "OpenAI", icon: "simple-icons:openai" },
  { name: "Anthropic", icon: "simple-icons:anthropic" },
  { name: "Twilio", icon: "simple-icons:twilio" },
  { name: "Bitly", icon: "simple-icons:bitly" },
];

const allTools = [...row1, ...row2, ...row3];

const GAP = 48;
const trackStyle = `gap: ${GAP}px; padding-right: ${GAP}px;`;

const desktopRows = [
  { tools: row1, animation: "animate-scroll-left" },
  { tools: row2, animation: "animate-scroll-right" },
  { tools: row3, animation: "animate-scroll-left-slow" },
];

const TRACK_COUNT = [0, 1, 2];
---

<section class="py-10 lg:py-12 bg-zinc-900 overflow-hidden">
  <p class="text-center fluid-text-xs uppercase text-zinc-400 mb-4 lg:mb-5 px-6">
    Vous utilisez ces outils ? Je les ai déjà automatisés. Tous.
  </p>

  <!-- Mobile: single row -->
  <div class="md:hidden relative">
    <ScrollFade color="zinc-900" width="w-16" />

    <div class="flex overflow-hidden">
      {TRACK_COUNT.map((i) => (
        <div
          class="flex items-center shrink-0 animate-scroll-left-mobile"
          style={trackStyle}
          aria-hidden={i > 0 ? "true" : undefined}
        >
          {allTools.map((tool) => (
            <div class="flex items-center gap-2 shrink-0 text-zinc-400 whitespace-nowrap">
              <Icon name={tool.icon} class="w-5 h-5" />
              <span class="fluid-text-sm font-medium">{tool.name}</span>
            </div>
          ))}
        </div>
      ))}
    </div>
  </div>

  <!-- Desktop: 3 rows -->
  <div class="hidden md:block space-y-4">
    {desktopRows.map(({ tools, animation }) => (
      <div class="relative">
        <ScrollFade color="zinc-900" width="w-40" />

        <div class="flex overflow-hidden">
          {TRACK_COUNT.map((i) => (
            <div
              class={`flex items-center shrink-0 ${animation}`}
              style={trackStyle}
              aria-hidden={i > 0 ? "true" : undefined}
            >
              {tools.map((tool) => (
                <div class="flex items-center gap-2 shrink-0 text-zinc-400 hover:text-zinc-200 transition-colors duration-150 whitespace-nowrap">
                  <Icon name={tool.icon} class="w-6 h-6" />
                  <span class="fluid-text-sm font-medium">{tool.name}</span>
                </div>
              ))}
            </div>
          ))}
        </div>
      </div>
    ))}
  </div>
</section>

<style>
  .animate-scroll-left {
    animation: scroll-left 70s linear infinite;
  }

  .animate-scroll-right {
    animation: scroll-right 80s linear infinite;
  }

  .animate-scroll-left-slow {
    animation: scroll-left 90s linear infinite;
  }

  .animate-scroll-left-mobile {
    animation: scroll-left 120s linear infinite;
  }

  @media (prefers-reduced-motion: reduce) {
    .animate-scroll-left,
    .animate-scroll-right,
    .animate-scroll-left-slow,
    .animate-scroll-left-mobile {
      animation: none;
    }
  }
</style>
