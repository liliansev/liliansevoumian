---
import { Icon } from 'astro-icon/components';
import CTAButton from './ui/CTAButton.astro';

const services = [
  {
    id: "coaching",
    explanation: {
      title: "Un blocage ? Une question ?",
      before: "Vous êtes coincé sur un scénario. Vous hésitez sur une architecture. Vous avez besoin d'un œil externe et expert.",
      after: "En 1h, c'est débloqué. Vous savez quoi faire et comment."
    },
    card: {
      name: "Coaching",
      price: "150 €",
      features: [
        "Call 1h en visio",
        "Réponses claires",
        "Replay disponible"
      ],
      cta: "Réserver ma session",
      href: "https://cal.com/lilian-sevoumian/coaching-1"
    }
  },
  {
    id: "audit",
    featured: true,
    explanation: {
      title: "Arrêtez de naviguer à vue.",
      before: "Vous ne savez pas si vous avez les bons outils. Vous perdez du temps sur des tâches répétitives. Vous sentez que ça pourrait être mieux — mais par où commencer ?",
      after: "Vous recevez un livrable actionnable sous 72h :",
      afterList: [
        "Les bons outils pour votre activité (et pourquoi)",
        "Ce que vous pouvez automatiser dès maintenant",
        "Un plan d'action priorisé"
      ],
      bonus: "Vous recevez un document complet + une vidéo personnalisée pour tout vous expliquer.",
      options: ["Diagnostic Stack", "Audit Process"]
    },
    card: {
      name: "Diagnostic",
      price: "350 €",
      featuresLabel: "Comment ça se passe",
      features: [
        "Call 45min en visio",
        "Analyses de mon côté",
        "Livrable + vidéo sous 72h"
      ],
      numbered: true,
      cta: "Réserver mon audit",
      href: "https://cal.com/lilian-sevoumian/audit"
    }
  },
  {
    id: "projet",
    explanation: {
      title: "Vous voulez que ça tourne. Sans vous.",
      before: "Vous faites tout à la main. Ça prend des heures. Vous savez que c'est automatisable mais vous n'avez pas le temps de vous y mettre.",
      after: "Vos automatisations sont en place. Ça tourne. Vous récupérez des heures chaque semaine."
    },
    card: {
      name: "Mission complète",
      price: "→ Selon vos besoins",
      features: [
        "Scénarios optimisés, pas du bricolage",
        "Tests jusqu'à ce que ça tourne",
        "30 jours de SAV inclus"
      ],
      cta: "Discuter de mon projet",
      href: "https://lilian.yt/contact"
    }
  }
];
---

<section id="tarifs" class="py-24 px-6 bg-zinc-50">
  <div class="max-w-5xl mx-auto">
    <!-- Header -->
    <div class="mb-16 text-center">
      <h2 class="fluid-h1 font-semibold text-zinc-900 mb-4">
        Mes services
      </h2>
      <p class="text-zinc-700 font-light fluid-text-xl leading-relaxed">
        Des formules claires, adaptées à vos besoins.
      </p>
    </div>

    <!-- Services Grid -->
    <div class="space-y-8">
      {services.map((service) => (
        <div class={`grid md:grid-cols-2 gap-6 md:gap-10 items-center ${service.featured ? 'pricing-row-featured' : ''}`}>
          <!-- Explanation Column -->
          <div class="space-y-4">
            <h3 class="fluid-h3 font-semibold text-zinc-900">
              {service.explanation.title}
            </h3>

            <div class="space-y-3 fluid-text-sm">
              <div>
                <span class="text-zinc-400 font-medium text-xs">Avant</span>
                <p class="text-zinc-500 mt-1">{service.explanation.before}</p>
              </div>

              <div>
                <span class="text-zinc-900 font-medium text-xs">Après.</span>
                <p class="text-zinc-800 mt-1">{service.explanation.after}</p>
                {service.explanation.afterList && (
                  <ul class="mt-2 space-y-1 text-zinc-700">
                    {service.explanation.afterList.map((item) => (
                      <li class="flex items-start gap-2">
                        <span class="text-zinc-400">–</span>
                        <span>{item}</span>
                      </li>
                    ))}
                  </ul>
                )}
                {service.explanation.bonus && (
                  <p class="mt-3 text-zinc-600 italic text-xs">{service.explanation.bonus}</p>
                )}
              </div>

              {service.explanation.options && (
                <div class="flex gap-2 mt-2">
                  {service.explanation.options.map((option) => (
                    <span class="px-3 py-1 bg-zinc-100 rounded-full text-xs text-zinc-600">
                      {option}
                    </span>
                  ))}
                </div>
              )}
            </div>
          </div>

          <!-- Card Column -->
          <div class={`relative p-6 bg-white rounded-2xl transition-all ${service.featured ? 'shadow-lg pricing-featured' : 'border border-zinc-200/80 shadow-sm card-interactive'}`}>
            {service.featured && (
              <div class="absolute -top-3 left-1/2 -translate-x-1/2 px-3 py-1 bg-zinc-900 text-white text-xs font-medium uppercase tracking-wider rounded-full z-10">
                Populaire
              </div>
            )}

            <!-- Plan Name -->
            <h4 class="fluid-h4 font-semibold text-zinc-900 mb-2">
              {service.card.name}
            </h4>

            <!-- Price -->
            <div class="mb-4 whitespace-nowrap">
              <span class="fluid-h4 font-semibold text-zinc-900">
                {service.card.price}
              </span>
              {!service.card.price.startsWith("→") && (
                <span class="text-xs text-zinc-500 ml-1">ht</span>
              )}
            </div>

            <!-- Features List -->
            {service.card.featuresLabel && (
              <p class="text-xs text-zinc-500 mb-2">{service.card.featuresLabel}</p>
            )}
            <ul class="space-y-2.5 mb-6">
              {service.card.features.map((feature, index) => (
                <li class="flex items-start gap-2.5 fluid-text-sm">
                  {service.card.numbered ? (
                    <span class="text-sm font-semibold text-zinc-400 font-mono shrink-0">
                      {String(index + 1).padStart(2, '0')}
                    </span>
                  ) : (
                    <div class={`w-5 h-5 rounded-full flex items-center justify-center shrink-0 mt-0.5 ${service.featured ? 'bg-zinc-900' : 'bg-zinc-200'}`}>
                      <Icon name="lucide:check" class={`w-3 h-3 ${service.featured ? 'text-white' : 'text-zinc-600'}`} />
                    </div>
                  )}
                  <span class="text-zinc-700">{feature}</span>
                </li>
              ))}
            </ul>

            <!-- CTA -->
            <CTAButton
              href={service.card.href}
              text={service.card.cta}
              variant={service.featured ? 'primary' : 'secondary'}
              size="md"
              fullWidth={true}
            />
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  .pricing-featured {
    position: relative;
    background: white;
    border-radius: 1rem;
    border: 1px solid #a1a1aa;
  }

  @supports (background: paint(something)) {
    .pricing-featured {
      border: none;
    }
  }

  .pricing-featured::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 1rem;
    padding: 1px;
    pointer-events: none;
    background: linear-gradient(
      var(--gradient-angle, 0deg),
      #18181b,
      #a1a1aa,
      #18181b
    );
    -webkit-mask:
      linear-gradient(#fff 0 0) content-box,
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    animation: rotate-gradient 4s linear infinite;
  }

  @keyframes rotate-gradient {
    0% {
      --gradient-angle: 0deg;
    }
    100% {
      --gradient-angle: 360deg;
    }
  }

  @property --gradient-angle {
    syntax: '<angle>';
    initial-value: 0deg;
    inherits: false;
  }

  .pricing-row-featured {
    padding: 1.5rem;
    background: linear-gradient(to right, rgba(244, 244, 245, 0.8), rgba(250, 250, 250, 0.3));
    border-radius: 1.5rem;
    margin-left: -1.5rem;
    margin-right: -1.5rem;
  }

  @media (max-width: 768px) {
    .pricing-row-featured {
      margin-left: -0.75rem;
      margin-right: -0.75rem;
      padding: 1rem;
    }
  }
</style>
